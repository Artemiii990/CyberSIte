<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Risk Analysis — Final Version</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--accent:#7c3aed;--muted:#94a3b8;}
    *{box-sizing:border-box;font-family:Inter,system-ui,sans-serif}
    body{margin:0;background:linear-gradient(180deg,#0b1020 0%,#080d1a 100%);color:#f1f5f9}
    .container{max-width:1100px;margin:36px auto;padding:24px}
    header{display:flex;align-items:center;gap:18px;margin-bottom:16px}
    .logo{width:70px;height:70px;background:linear-gradient(135deg,var(--accent),#06b6d4);border-radius:14px;display:flex;align-items:center;justify-content:center;font-weight:800;font-size:22px}
    h1{margin:0;font-size:22px}
    .lead{color:var(--muted);margin:4px 0 0}
    .grid{display:grid;grid-template-columns:1fr 380px;gap:20px;margin-top:16px}
    .card{background:rgba(255,255,255,0.03);border-radius:14px;padding:18px;border:1px solid rgba(255,255,255,0.05);box-shadow:0 4px 14px rgba(0,0,0,0.4)}
    table{width:100%;border-collapse:collapse;color:#e2e8f0}
    th,td{padding:10px 12px;text-align:left}
    th{background:rgba(255,255,255,0.05);font-weight:600}
    tr:nth-child(even){background:rgba(255,255,255,0.02)}
    .pill{padding:4px 10px;border-radius:999px;font-size:13px}
    .low{background:rgba(34,197,94,0.15);color:#86efac}
    .med{background:rgba(250,204,21,0.15);color:#fde68a}
    .high{background:rgba(239,68,68,0.15);color:#fecaca}
    .controls{margin-top:10px;display:flex;gap:10px;flex-wrap:wrap}
    .btn{background:var(--accent);border:none;padding:8px 14px;border-radius:8px;color:#fff;font-weight:600;cursor:pointer}
    .btn.secondary{background:transparent;border:1px solid rgba(255,255,255,0.1)}
    canvas{width:100%!important;height:320px!important;margin-top:10px}
    footer{margin-top:18px;color:var(--muted);font-size:13px;text-align:center}
    @media(max-width:900px){.grid{grid-template-columns:1fr}}
    aside.card {
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        align-items: center;
        height: 100%;
    }

    .container-logo-aside {
        display: flex;
        justify-content: center;
        align-items: flex-end;
        width: 100%;
        padding-bottom: 10px;
    }

    .container-logo-aside img {
        width: 200px;
        height: auto;
        border-radius: 8px;
        padding: 8px;
        background: none;
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="logo">RA</div>
      <div>
        <h1>Risk Analysis — Project Overview</h1>
        <p class="lead">Interactive risk table and visual impact analysis.</p>
      </div>
    </header>

    <div class="grid">
      <section class="card">
        <h2>Risk Table</h2>
        <table id="riskTable">
          <thead><tr><th>#</th><th>Risk</th><th>Description</th><th>Probability</th><th>Impact</th><th>Strategy</th></tr></thead>
          <tbody></tbody>
        </table>
        <div class="controls">
          <button class="btn" id="downloadCsv">Download CSV</button>
          <button class="btn secondary" id="addRisk">Add Risk</button>
        </div>
      </section>

      <aside class="card">
        <canvas id="pieChart"></canvas>
      <div class="container-logo-aside">
          <a href="./index.html" >
              <img
                      src="assets/images/logo.png"
                      width="150"
                      height="150"
                      alt="unigine home"
              />
          </a>
      </div>
      </aside>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    const demoRisks = [
      {id:1,name:'Security breach',desc:'Leakage or loss of sensitive data.',prob:'High',impact:'High',strategy:'Implement encryption, audits, MFA.'},
      {id:2,name:'Schedule delay',desc:'Late delivery of modules.',prob:'Medium',impact:'Medium',strategy:'Reserve time, iterations.'},
      {id:3,name:'Budget overrun',desc:'Costs exceed the plan.',prob:'Medium',impact:'High',strategy:'Monitor expenses, reserve fund.'},
      {id:4,name:'Technical failure',desc:'Technology malfunction.',prob:'Low',impact:'High',strategy:'Testing, backups.'},
      {id:5,name:'Supplier dependency',desc:'Supplier delays.',prob:'Medium',impact:'Medium',strategy:'Alternative suppliers, SLA.'}
    ];
    const probMap={'Low':1,'Medium':3,'High':5},impactMap={'Low':1,'Medium':3,'High':5};

    function renderTable(){
      const tbody=document.querySelector('#riskTable tbody');
      tbody.innerHTML='';
      demoRisks.forEach((r,i)=>{
        const tr=document.createElement('tr');
        tr.innerHTML=`<td>${i+1}</td><td><strong>${r.name}</strong></td><td>${r.desc}</td>
        <td><span class="pill ${r.prob==='High'?'high':r.prob==='Medium'?'med':'low'}">${r.prob}</span></td>
        <td><span class="pill ${r.impact==='High'?'high':r.impact==='Medium'?'med':'low'}">${r.impact}</span></td>
        <td>${r.strategy}</td>`;
        tbody.appendChild(tr);
      });
    }

    function drawPie(){
      const ctx=document.getElementById('pieChart').getContext('2d');
      const labels=demoRisks.map(r=>r.name);
      const data=demoRisks.map(r=>probMap[r.prob]*impactMap[r.impact]);
      new Chart(ctx,{
        type:'pie',
        data:{
          labels,
          datasets:[{
            label:'Total risk',
            data,
            backgroundColor:['#7c3aed','#06b6d4','#10b981','#facc15','#ef4444'],
            borderWidth:2,
            borderColor:'#0b1220'
          }]
        },
        options:{
          plugins:{
            legend:{
              position:'bottom',
              labels:{
                color:'#f1f5f9',
                font:{size:14,weight:'500'}
              }
            },
            title:{display:false}
          },
          animation:{animateRotate:true,duration:1200}
        }
      });
    }

    document.getElementById('downloadCsv').onclick=()=>{
      const csv = [['#','Risk','Description','Probability','Impact','Strategy'],...demoRisks.map((r,i)=>[i+1,r.name,r.desc,r.prob,r.impact,r.strategy])].map(r=>r.join(',')).join('\n');
      const blob=new Blob([csv],{type:'text/csv'});const a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download='risks.csv';a.click();
    };

    document.getElementById('addRisk').onclick=()=>{
      const name=prompt('Risk name:');if(!name)return;
      demoRisks.push({id:demoRisks.length+1,name,desc:'Description',prob:'Medium',impact:'Medium',strategy:'Mitigations'});
      renderTable();drawPie();
    };

    renderTable();
    drawPie();
  </script>
</body>
</html>
